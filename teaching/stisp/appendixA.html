<!doctype html>
<html lang="zh-Hant-TW">

<head>
<meta charset="utf-8">

<title>附錄 A - VBE 設定</title>

<meta name="description" content="Tutorial of web design for primer">
<meta name="author" content="Elvis Hsieh">

<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
<!-- Favicon-->
<link rel="icon" type="image/x-icon" href="/images/elogo.ico" />

<link rel="stylesheet" href="/revealjs/dist/reset.css">
<link rel="stylesheet" href="/revealjs/dist/reveal.css">
<link rel="stylesheet" href="/revealjs/dist/theme/black.css" id="theme">
<link rel="stylesheet" href="/revealjs/plugin/chalkboard/style.css">
<link rel="stylesheet" href="/revealjs/plugin/customcontrols/style.css">
<link rel="stylesheet" href="/css/custom4revealjs.css">
<!-- Code syntax highlighting -->
<link rel="stylesheet" href="/highlightjs/styles/monokai.min.css">   
<link rel="stylesheet" href="/css/style4font.css">
<!-- Printing and PDF exports -->
<script>
var link = document.createElement( 'link' );
link.rel = 'stylesheet';
link.type = 'text/css';
link.href = window.location.search.match( /revealjs/print-pdf/gi ) ? '/revealjs/dist/print/pdf.css' : '/revealjs/dist/print/paper.css';
document.getElementsByTagName( 'head' )[0].appendChild( link );
</script>

<!--[if lt IE 9]>
<script src="reveal-js/lib/js/html5shiv.js"></script>
<![endif]-->
</head>
<body>

<div class="reveal">

<!-- Any section element inside of this container is displayed as a slide -->
<div class="slides">

<section><!--start block-->
<section data-markdown><script type="text/template">
# 附錄 A <br /> Settup IDE
</script></section>
<section data-markdown><script type="text/template">
# Brief Excel
</script></section>
<section data-markdown><script type="text/template">
## [Excel File Format](https://support.microsoft.com/zh-tw/office/excel-%E4%B8%AD%E6%94%AF%E6%8F%B4%E7%9A%84%E6%AA%94%E6%A1%88%E6%A0%BC%E5%BC%8F-0943ff2c-6014-4e8d-aaea-b83d51d46247)
| |Excel 97-2003 | Excel 2007 or later |
| :--- | :--- | :--- |
| .xls | workbook file format| |
| .xlt | template file format| |
| .xla | add-Ins file format| |
| .xlsx | | workbook file format|
| .xltx | | template file format|
| .xlsm | | **workbook with macros**|
| .xlam | | **add-Ins file format**|
| .xlsb | | **binary file format**|
</script></section>
<section data-markdown><script type="text/template">
## Compare Excel 97-2003 with 2007
- Excel 97-2003 file format
	- The .xls is a wookbook and **a binary file type, which have many macros in it**.
	- It support **65536 rows and 256 columns** in a wookbook.
	- It was **difficult** to convert to others file type
- Excel 2007 file format
	- The .xlsx is a wookbook **without macros** in it. Macro can been saved with .xlsm, .xlsb, and .xlam file format. 
	- It support **1 million rows and 16384 columns** in a wookbook.
	- It was **easy** to convert to others file type.
</script></section>
<section data-markdown><script type="text/template">
## 開啟「開發人員」索引標籤
- 檔案 >> 其他 >> 選項 >> 自訂功能區 >> 勾選「開發人員」
![](/images/stisp/developer.png)
</script></section>
<section data-markdown><script type="text/template">
## Setting Develompent Env. for VBA
- Installing RubberDuck for VBE
	- Download RubberDuck from [rubberduck offical website](https://rubberduckvba.com/)
	- Installing RubberDuck
- 設定 VBA 模組信任層級
	- 檔案 >> 選項 >> 信任中心 >> 信任中心設定 >> 巨集設定 >> 勾選「啟用 VBA 巨集/信任存取專案 VBA 物件模型」
	- **See next slide**
</script></section>
<section data-markdown><script type="text/template">
## 設定 VBA 模組信任層級(1/2)
- Open Excel >> 選項 >> 信任中心 >> 信任中心設定
![](/images/stisp/trust.png)
</script></section>
<section data-markdown><script type="text/template">
## 設定 VBA 模組信任層級(2/2)
![](/images/stisp/trust2.png)
</script></section>
</section><!--end block-->

<section><!--start block-->
<section data-markdown><script type="text/template">
# VBE Big5 編碼問題
</script></section>
<section data-markdown><script type="text/template">
## VBE 字型設定問題(1/2)
- 工具 >> 選項 >> 撰寫風格 >> 字型
![](/images/stisp/setFont.png)
</script></section>
<section data-markdown><script type="text/template">
## VBE 字型設定問題(2/2)
- 工具 >> 選項 >> 撰寫風格 >> 字型 >> 點選**西歐字型**
![](/images/stisp/setFont2.png)
</script></section>
<section data-markdown><script type="text/template">
## Visual Basic Editor 亂碼問題
- **The Visual Basic Editor does not support Unicode encoding**, neither for input, nor for display.
- The VBA editor still uses the old "code page" character encodings based on the locale setting in Windows.
- 修改 **Excel 工作表名稱，不要使用中文命名**，避免亂碼問題
- 修改 **VBA 工作屬性的名稱，不要使用中文命名**，避免亂碼問題
- 採用 **VS Code 內建的 UTF-8 ⇌ Big5 編碼**
- [VBE 無法正確顯示中文字](#/2/3)，變更系統地區設定，**不要勾選「使用 Unicode UTF-8 提供全球語言支援」**
</script></section>
<section data-markdown><script type="text/template">
## VBE 中文名稱
![](/images/stisp/vbeChinese.png)
</script></section>
<section data-markdown><script type="text/template">
## 修改 VBE 中文名稱
![](/images/stisp/vbeEnglish.png)
</script></section>
<section data-markdown><script type="text/template">
## VBE 無法正確顯示中文字
![](/images/stisp/big5VBE.png)
</script></section>
<section data-markdown><script type="text/template">
## 變更系統地區設定
![](/images/stisp/utf8Setting.png)
</script></section>
</section><!--end block-->

<section><!--start block-->
<section data-markdown><script type="text/template">
# Setting <br/>VS Code for VBA
</script></section>
<section data-markdown><script type="text/template">
## Install VS Code Extension for VBA
- Why should we use VS Code editor to develop VBA?
	- VBE was not a friendly Integration Develompent Enviromment(IDE). VS Code editor was a good one.
- Which VS Code extension should install for VBA?
1. VBA Full Code Snippets
2. XVBA - Live Server VBA
3. XVBA - Ribbon Menu
4. Codeium: Free AI-powered code acceleration toolkit
- How to install these VS Code extensions as above? This tutorial video is for you. ([a02VScodeExtension](https://drive.google.com/drive/u/2/folders/1COWsdSGKXg4gnQngY9du0jHCxVo8lnMR))
</script></section>
<section data-markdown><script type="text/template">
# Setting up <br/>XVBA Extension
</script></section>
<section data-markdown><script type="text/template">
## Setting XVBA for VS Code
- 建立一個資料夾，for example, d:\excel-project/xvba
- **VS Code >> File >> Open Folder >> d:\excel-project/xvba**
- 新增 Excel 檔案，**儲存檔名為 index.xlsb**
- 點選 VS Code 左側下方的 **XVBA - MACRO LIST 中的 Boostrap 按鈕**，建立 XVBA Extension 套件的設定檔
- Export/Import VBA 程式碼
	- Export 按鈕：將 VBA 程式碼從 VS Code 中輸出到 d:\excel-project/xvba/index.xlsb
	- Import 按鈕：將 VBA 程式碼從 d:\excel-project/xvba/index.xlsb 輸入到 VS Code
	-  **以 VS Code 為主 export/import VBA code**
</script></section>
</section><!--end block-->

<section><!--start block-->
<section data-markdown><script type="text/template">
# xlwings for VS Code
</script></section>
<section data-markdown><script type="text/template">
# Python Installation
</script></section>
<section data-markdown><script type="text/template">
## Instll Python how to(1/7)
- Where have you installed [Python](https://www.python.org/downloads/) in the System?
	- Windows: **_where python_**, Unix-like: **_which python_**
![](/images/stisp/wherePy.png)
</script></section>
<section data-markdown><script type="text/template">
## Instll Python how to(2/7)
- Download and install [Python](https://www.python.org/downloads/) in the System
	- Select "customize installation" and Add python.exe to PATH
![](/images/stisp/pyInstall.png)
</script></section>
<section data-markdown><script type="text/template">
## Instll Python how to(3/7)
- Make sure what you want to install Python in the System?
![](/images/stisp/pyInstall2.png)
</script></section>
<section data-markdown><script type="text/template">
## Instll Python how to(4/7)
- For example, it is installed in C:\Python
![](/images/stisp/pyInstall3.png)
</script></section>
<section data-markdown><script type="text/template">
## Instll Python how to(5/7)
- Check Python version with **_python -V_** command
![](/images/stisp/pyVersion.png)
</script></section>
<section data-markdown><script type="text/template">
## Instll Python how to(6/7)
- Update Python
![](/images/stisp/updatePy.png)
</script></section>
<section data-markdown><script type="text/template">
# Portable Python 
</script></section>
<section data-markdown><script type="text/template">
## Install portable Python
- 電腦教室使用還原卡，需要安裝 portable Python 到 D:\
- Download Portable [python-3.12.2-embed-amd64.zip](https://www.python.org/ftp/python/3.12.2/python-3.12.2-embed-amd64.zip)
- Extract Portable Python in D:\
- Setting Python Path in Windows
	- 系統 >> 進階系統設定 >> 環境變數 >> 使用者變數 >> Path，加入 D:\Python 以及 D:\Python\Scripts 路徑
- Install pip which is a Python package manager
	- Downlooad get-pip from [this site](https://bootstrap.pypa.io/get-pip.py)
	- Install pip with **_py get-pip.py_** command
- 修改 D:\Python\python312._pth, uncomment #import site
	- Test pip with **_pip list_** command
</script></section>
<section data-markdown><script type="text/template">
## Setting environment variable
- Setting environment variable for Python
	- d:\python and d:\python\Scripts path into Windows PATH variable, alternatively, you can write a batch file to run it when you want to be. The batch code was as following
<pre><code>@echo off
SET PYTHONPATH=D:\python
SET PATH=%PYTHONPATH%;%PYTHONPATH%\Scripts;%PATH%
echo "The PATH environment variable have been setted for Python."
</code></pre>
</script></section>	
<section data-markdown><script type="text/template">
## Move and Upgrade pacakges
- Moving Portable Python to the other system
	- **_py -m pip install --upgrade --force-reinstall pip_**
- Upgrade all of package
	- Download [awk for Windows](https://gnuwin32.sourceforge.net/downlinks/gawk-bin-zip.php) and set environment variable
	- Run the batch file: pyUpgrade.bat
<pre><code>echo off
python -m pip install --upgrade pip
pip list --outdated | awk '{ print $1 }' > temp.txt
more +2 temp.txt > requirements.txt
pip install -r .\requirements.txt --upgrade
del requirements.txt temp.txt</code></pre>
</script></section>
</section><!--end block-->

<section><!--start block-->
<section data-markdown><script type="text/template">
# Installing and Setting xlwings
</script></section>
<section data-markdown><script type="text/template">
## Installing xlwings for VS Code
- Install [Python](https://www.python.org/)
- Install xlwings and watchgod
	- **_pip install xlwings watchgod_**
- Testing xlwings for VS Code
	- 開啟 VS Code, 建立一個資料夾[(excel-project/xlwings)](https://drive.google.com/drive/u/2/folders/1Y4bT1ieU0eEGITgPusIIAFVvDeONjY71)
	- 建立一個 Excel 檔案，檔名儲存為 .xlsm(demo.xlsm)
	- 在 .xlsm 檔案中插入一個 Module(Module1)
	- 在 .xlsm 開啟狀態下開啟 VS Code Cmd line(Ctrl + ~)
	- 執行 **xlwings vba export**
	- 在 VS Code Command line 命令列執行 xlwings vba edit，檢查是否可以 Live 編輯 VBA 程式碼?
</script></section>
<section data-markdown><script type="text/template">
## Export/Import VBA Module
- Export VBA code to VS Code
	- Create a folder for VBA project
	- **open a filename with .xlsm extension**
	- **xlwings vba export**
	- open VBA code with VS code
- Import VBA code from VS Code
	- Create a folder for VBA project
	- Copy the Moudle2.bas into the folder of VBA project
	- **Open a filename with .xlsm extension**
	- **xlwings vba import**
	- open VBA code with VS code
</script></section>
<section data-markdown><script type="text/template">
## Import VBA Module Format
<pre><code>' Filename: Module1.bas
Attribute VB_Name = "Module1"
' VBA code
...
</code></pre>
- **Filename 與 Attribute VB_Name 指定的名稱必須相同**
- 在 xlwing vba edit live server 狀態下**不可以在 VS Code 中直接加入 Module1.bas**
- 在 xlwing vba edit live server 狀態下，可以在 Excel 中加入 Module，但無法 live 同步到 VS Code，必須停止 live server 以後，
再使用 xlwings vba export 指令將 VBA 程式碼輸出
</script></section>
<section data-markdown><script type="text/template">
## Try by yourself
- 安裝 Python and xlwings
- 下載練習資料[(excel-project/xlwings)](https://drive.google.com/drive/u/2/folders/1Y4bT1ieU0eEGITgPusIIAFVvDeONjY71)
- 開啟 demo.xlsm 檔案，在檔案中插入一個 Module（Module1）
- 開啟 VS Code，將 excel-project 資料夾拖曳進 VS Code 左邊的 EXPLORER 中
- 開啟 VS Code Cmd line，執行 **xlwings vba export**
- 在 VS Code Command line 命令列執行 xlwings vba edit，檢查是否可以 Live 編輯 VBA 程式碼?
- Ctrl + C 跳出 live server，執行 **xlwings vba import**，檢查是否將 Module2 載入到 demo.xlsm 檔案中
</script></section>
<section data-markdown><script type="text/template">
## xlwings for Python
- xlwings vba edit
	- Setting xlwings
	- Launch Powershell or cmd as a Administrator
	- **_xlwings license update -k noncommerical_**
	- **_xlwings addin install_** // or remove
- Create a xlwings project
	- create a folder for excel vba project
	- xlwings quickstart myproject
	- launch VS Code and press Ctrl + ~ to open the command line, then run the following command
- More information: **_xlwings -h_**
</script></section>
</section><!--end block-->

<section><!-- start block-->
<section data-markdown><script type="text/template">
# Debugging
</script></section>
<section data-markdown><script type="text/template">
## Debug with VBE (1/3)
- Enable Debug Toolbars
	- **檢視 >> 工具列 >> 偵錯**
- Downlad the [debugDemo.xlsm](https://drive.google.com/file/d/1N2hb-7R36ziz6-kF02mye5xQsQKwe206/view?usp=drive_link) file from my GoogleDriver
- Source code of debugDemo.xlsm
<pre><code>Option Explicit
Public Sub addCells()
	Dim x As Integer
	Dim y As Integer
	x = Cells(1, 1).Value
	y = Cell(3, 2).Value  'error here
	x = x + 100
	y = y + 20
	Cells(1, 1) = x
	Cells(3, 2) = y
End Sub</code></pre>
</script></section>
<section data-markdown><script type="text/template">
## Debug with VBE (2/3)
- Source code of debugDemo.xlsm
<pre><code>Public Sub goodCode()
	MsgBox "This code is working."
End Sub
Public Sub badCode()
	Application.Delete
End Sub
Public Sub clearValue()
Cells.Clear
End Sub</code></pre>
- Debugging
	- 游標置放在 Sub addCells() 這一行，按工具列的"執行"按鈕(F5)，執行這個 Sub 程式碼
</script></section>
<section data-markdown><script type="text/template">
## Debug with VBE (3/3)
- Debugging
	- 游標置放在 option explicit or Sub 之間的空白行，按工具列的"執行"按鈕(F5)，選擇要執行的 Sub 程式碼
- Debugging VBA step by step
	- **按工具列的"逐步"按鈕(F8)，逐步執行 Sub 程式碼**
- Setting stop point
	- 按工具列的"切換中斷點"按鈕(F9) or 滑鼠點選程式碼的左側的，設定停止點
- **開啟 "區域變數視窗"，可以檢視 Sub 程式碼中區域變數的數值**
	- Run getChar Module in debugDemo.xlsm
</script></section>
</section><!--end block-->	
</div>
</div>

<script src="/revealjs/lib/js/head.min.js"></script>
<script src="/revealjs/dist/reveal.js"></script>
<script src="/revealjs/plugin/zoom/zoom.js"></script>
<script src="/revealjs/plugin/notes/notes.js"></script>
<script src="/revealjs/plugin/search/search.js"></script>
<script src="/revealjs/plugin/markdown/markdown.js"></script>
<script src="/revealjs/plugin/highlight/highlight.js"></script>
<script src="/revealjs/plugin/menu/menu.js"></script>
<script src="/revealjs/plugin/math/math.js"></script>
<script src="/revealjs/plugin/chalkboard/plugin.js"></script>
<script src="/revealjs/plugin/customcontrols/plugin.js"></script>
<script src="/revealjs/plugin/animate/svg.min.js"></script>
<script src="/revealjs/plugin/animate/plugin.js"></script>

<script>
Reveal.initialize({
controls: true,
progress: true,
history: true,
center: true,
slideNumber: true,
mouseWheel: true,
transition: 'fade', // none/fade/slide/convex/concave/zoom

menu: {
	side: 'left',
	width: 'normal',
	numbers: false,
	titleSelector: 'h1, h2, h3, h4, h5, h6',
	useTextContentForMissingTitles: false,
	hideMissingTitles: false,
	markers: true,
	custom: true,
	themes: true,
	themesPath: '/revealjs/dist/theme/',
	transitions: true,
	openButton: true,
	openSlideNumber: false,
	keyboard: true,
	sticky: false,
	autoOpen: true,
	delayInit: false,
	openOnInit: false,
	loadIcons: true,
	
	custom: [
			{ title: 'TOC', icon: '<i class="fa fa-external-link-alt">', src: 'links.html' },
			{ title: 'About', icon: '<i class="fa fa-info">', content: '<p>Slides for teaching Office Suite Softwar</p>' }
	]
},

customcontrols: {
	controls: [
	{
		id: 'toggle-overview',
		title: 'Toggle overview (O)',
		icon: '<i class="fa fa-th"></i>',
		action: 'Reveal.toggleOverview();'
	},
	{ icon: '<i class="fa fa-pen-square"></i>',
		title: 'Toggle chalkboard (B)',
		action: 'RevealChalkboard.toggleChalkboard();'
	},
	{ icon: '<i class="fa fa-pen"></i>',
		title: 'Toggle notes canvas (C)',
		action: 'RevealChalkboard.toggleNotesCanvas();'
	}
	]
},

toolbar: {
	// Specifies where the toolbar will be shown: 'top' or 'bottom'
	position: 'bottom',

	// Add button to toggle fullscreen mode for the presentation
	fullscreen: true,

	// Add button to toggle the overview mode on and off
	overview: true,

	// Add button to pause (hide) the presentation display
	pause: true,

	// Add button to show the speaker notes
	notes: false,

	// Add button to show the help overlay
	help: false,

	// If true, the reveal.js-menu will be moved into the toolbar.
	// Set to false to leave the menu on its own.
	captureMenu: true,

	// If true, the playback control will be moved into the toolbar.
	// This is only relevant if the presentation is configured to autoSlide.
	// Set to false to leave the menu on its own.
	capturePlaybackControl: true,

	// By default the menu will load it's own font-awesome library
	// icons. If your presentation needs to load a different
	// font-awesome library the 'loadIcons' option can be set to false
	// and the menu will not attempt to load the font-awesome library.
	loadIcons: true
},

// Optional reveal.js plugins
plugins: [ RevealZoom, RevealNotes, RevealSearch, RevealMarkdown, RevealHighlight, RevealAnimate, RevealMenu, RevealCustomControls, RevealChalkboard, RevealMath.KaTeX ],

dependencies: [
//{ src: '/revealjs/plugin/toolbar/toolbar.js' }
]
});

</script>

</body>
</html>
